<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>CORS XHR request</title>
        <meta name="description" content="CORS XHR request">
        <meta name="author" content="orlovv">
    </head>
    <body>
        <div id="message">Loading...</div>
        <table id="table" border="1"></table>
        <script>
            var table = document.querySelector('#table');
            var message_div = document.querySelector('#message');

            var xhr = new XMLHttpRequest();
            xhr.open('GET', 'https://kodaktor.ru/j/users', true);
            xhr.send();

            xhr.onreadystatechange = function() {
                if (xhr.readyState != 4) return;

                if (xhr.status == 200) {
                    result = JSON.parse(xhr.responseText);
                    for (var i = 0; i < result["users"].length; i++) {
                        var user = result["users"][i];

                        var tr = document.createElement('tr');

                        var login = document.createElement('td');
                        login.appendChild(
                            document.createTextNode(user["login"])
                        );

                        var password = document.createElement('td');
                        password.appendChild(
                            document.createTextNode(user["password"])
                        );

                        tr.appendChild(login);
                        tr.appendChild(password);

                        table.appendChild(tr);
                    }
                    message_div.firstChild.nodeValue = "";
                } else {
                    message_div.firstChild.nodeValue = "error";
                }
            }
        </script>
    </body>
</html>
